tab_header(title = md("Will Grudzinski"),
subtitle = "Washington University | Last 5 Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(FGM = sum(Outcome),
FGA = n(),
`FG%` = 100 * round(FGM / FGA, 3)) %>%
ungroup()
read_csv("nyu_drives.csv")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = n(Outcome == "T"))
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = (Outcome == "T")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
Miss = sum(Outcome == "0"),
Make = sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA))
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA)) %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt()
nyu_drives <-
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3))
nyu_drives %>%
gt()
summarize(nyu_drives)
sum(nyu_drives)
nyu_drives.sum(
)
nyu_drives <-
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
adorn_totals("row") %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Shot Type`)) %>%
tab_header(title = md("Will Grudzinski"),
subtitle = "Washington University | Last 5 Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Will Grudzinski"),
subtitle = "Washington University | Last 5 Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | Against Brandeis, Hanover, Old Westbury")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | Against Brandeis, Hanover, Old Westbury")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt()
read_csv("nyu_drives.csv") %>%
mutate(Outcome = case_when(Outcome == "P" ~ "Pass",
Outcome == "T" ~ "Turnover",
Outcome == "F" ~ "Foul",
TRUE ~ "Shot Attempt")) %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt()
read_csv("nyu_drives.csv") %>%
mutate(Outcome = case_when(Outcome == "P" ~ "Pass",
Outcome == "T" ~ "Turnover",
Outcome == "F" ~ "Foul",
TRUE ~ "Shot Attempt")) %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = Outcome)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_drives.csv") %>%
mutate(Outcome = case_when(Outcome == "P" ~ "Pass",
Outcome == "T" ~ "Turnover",
Outcome == "F" ~ "Foul",
Outcome == "1" ~ "FGM",
TRUE ~ "FGA")) %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = Outcome)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_pnr.csv")
read_csv("nyu_pnr.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_pnr.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Pick-and-Roll Outcomes"),
subtitle = "New York University | 3 Closest Games")
library(tidyverse)
library(ggplot2)
library(gsheet)
library(gt)
rm(list = ls())
setwd("/Users/jeremydumalig/Documents/GitHub/Chicago-Analytics")
traditional_averages <- read_csv(file = "season_averages23.csv")
advanced_averages <- read_csv(file = "advanced_averages23.csv")
####################
traditional_averages <-
select(traditional_averages,
PTS, FGA, `3PA`, FTA, `FG%`, `3P%`, `FG%`,
AST, REB, OREB, DREB, STL, BLK, PF,
TOV,
`PTS OFF TOV`,
`2ND CHANCE`,
`PAINT`,
`FASTBREAK`,
BENCH)
####################
differential_sign <- function(number) {
if (number == 0) {
return("")
}
if (substr(format(number, nsmall = 1), 1, 1) != "-") {
return(paste("+", format(number, nsmall = 1), sep = ""))
} else {
return(paste("-", format(abs(number), nsmall = 1), sep = ""))
}
}
pregame_traditional <-
function(dataframe, type, opponent, location, date) {
if (location == 'Home') {
sub <- paste(date, ' | ', opponent, ' at UChicago', sep = '')
} else {
sub <- paste(date, ' | UChicago at ', opponent, sep = '')
}
dataframe <-
dataframe %>%
t() %>%
data.frame() %>%
mutate(Difference = as.numeric(X2) - as.numeric(X1))
dataframe %>%
mutate(Difference = map(dataframe$Difference, differential_sign)) %>%
select(X3, X1, Difference, X2) %>%
gt() %>%
cols_label(
X3 = '',
X1 = 'Chicago',
Difference = '',
X2 = 'Opponent'
) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = X3)) %>%
tab_style(style = list(cell_text(style = "italic", size = "small")),
locations = cells_body(columns = Difference)) %>%
tab_header(title = md(paste('**Pre-Game Report: ', type, '**', sep =
'')),
subtitle = sub)
}
pregame_advanced <-
function(dataframe, opponent, location, date) {
if (location == 'Home') {
sub <- paste(date, ' | ', opponent, ' at UChicago', sep = '')
} else {
sub <- paste(date, ' | UChicago at ', opponent, sep = '')
}
dataframe <-
dataframe %>%
select(-`...1`,-Team) %>%
t() %>%
data.frame() %>%
mutate(Difference = case_when(
(X3 == "PTS DIFF PER40") ~ 0,
TRUE ~ as.numeric(X2) - as.numeric(X1)
))
dataframe %>%
mutate(Difference = map(dataframe$Difference, differential_sign)) %>%
select(X3, X1, Difference, X2) %>%
gt() %>%
cols_label(
X3 = '',
X1 = 'Chicago',
Difference = '',
X2 = 'Opponent'
) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = X3)) %>%
tab_style(style = list(cell_text(style = "italic", size = "small")),
locations = cells_body(columns = Difference)) %>%
tab_header(title = md('**Pre-Game Report: Advanced**'),
subtitle = sub)
}
####################
info <- c('WashU', 'Away', '1/7/23')
pregame_traditional(traditional_averages, 'Traditional', info[1], info[2], info[3])
pregame_advanced(advanced_averages, info[1], info[2], info[3])
