plot.margin = margin(1, 0.5, 0.5, 0.5, "cm"),
plot.background = element_rect(fill = "grey90",
color = "black"),
legend.box.background = element_rect(size=0.75),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14),
plot.title = element_text(size=18,
face="bold"),
plot.subtitle = element_text(size=14),
plot.caption = element_text(size=10))
library(tidyverse)
library(ggplot2)
library(ggimage)
library(gsheet)
rm(list = ls())
women <- TRUE
mbb_logs <- read_csv("https://raw.githubusercontent.com/jeremydumalig/Chicago-Analytics/main/mbb_uaa_scout.csv")
wbb_logs <- read_csv("https://raw.githubusercontent.com/jeremydumalig/Chicago-Analytics/main/wbb_uaa_scout.csv")
mbb_games <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1BcIP7CIYDTNnedcRG3U3HAIwluaJtz8LCAKfArlEh98/edit#gid=136251738")
wbb_games <- gsheet2tbl("https://docs.google.com/spreadsheets/d/12JWqAMfVrSZobLohmxQK6PyrbNbOQbM6ux4LxXqWenM/edit#gid=1703250336")
logos <- read_csv("https://raw.githubusercontent.com/jeremydumalig/Chicago-Analytics/main/uaa_logos.csv")
if (women) {
logs <- wbb_logs
games <- wbb_games
subtitle <- "UAA Women's Basketball | Through December 30, 2022"
} else {
logs <- mbb_logs
games <- mbb_games
subtitle <- "UAA Men's Basketball | Through December 30, 2022"
}
logs <-
logs %>%
filter(Opponent == "Total") %>%
select(Team, `ORB%`, `DRB%`)
games <-
games %>%
filter(Game == "Total") %>%
mutate(Team = "Chicago") %>%
select(Team, `ORB%`, `DRB%`)
conference <-
rbind(logs, games) %>%
merge(logos,
by="Team")
conference %>%
ggplot(aes(x=`DRB%`,
y=`ORB%`)) +
geom_hline(yintercept=mean(conference$`ORB%`), linetype="dashed") +
geom_vline(xintercept=mean(conference$`DRB%`), linetype="dashed") +
geom_image(aes(image=URL),
size=0.1,
stat='identity') +
labs(title="Who are the best and worst rebounding teams?",
subtitle=subtitle,
x="Defensive Rebound Rate (DRB%)",
y="Offensive Rebound Rate (ORB%)") +
theme_linedraw() +
theme(
plot.margin = margin(1, 0.5, 0.5, 0.5, "cm"),
plot.background = element_rect(fill = "grey90",
color = "black"),
legend.box.background = element_rect(size=0.75),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14),
plot.title = element_text(size=18,
face="bold"),
plot.subtitle = element_text(size=14),
plot.caption = element_text(size=10))
# Select or deselect by column
?select
library(tidyverse)
library(gt)
library(gsheet)
library(janitor)
rm(list = ls())
setwd("/Users/jeremydumalig/Documents/GitHub/Chicago-Analytics")
library(tidyverse)
library(ggplot2)
library(gt)
library(gsheet)
library(janitor)
rm(list = ls())
setwd("/Users/jeremydumalig/Documents/GitHub/Chicago-Analytics")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(FGM = sum(Outcome),
FGA = n(),
`FG%` = 100 * round(FGM / FGA, 3)) %>%
ungroup() %>%
mutate(Frequency = 100 * round(FGA / sum(FGA), 3),
Splits = paste(as.character(FGM), "/", as.character(FGA), sep="")) %>%
arrange(desc(FGA)) %>%
select(`Shot Type`, Frequency, Splits, `FG%`) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Shot Type`)) %>%
tab_header(title = md("Will Grudzinski"),
subtitle = "Washington University | Last 5 Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(FGM = sum(Outcome),
FGA = n(),
`FG%` = 100 * round(FGM / FGA, 3)) %>%
ungroup()
read_csv("nyu_drives.csv")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = n(Outcome == "T"))
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = (Outcome == "T")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
Miss = sum(Outcome == "0"),
Make = sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA))
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA)) %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt()
nyu_drives <-
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3))
nyu_drives %>%
gt()
summarize(nyu_drives)
sum(nyu_drives)
nyu_drives.sum(
)
nyu_drives <-
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
adorn_totals("row") %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Shot Type`)) %>%
tab_header(title = md("Will Grudzinski"),
subtitle = "Washington University | Last 5 Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Will Grudzinski"),
subtitle = "Washington University | Last 5 Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | Against Brandeis, Hanover, Old Westbury")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | Against Brandeis, Hanover, Old Westbury")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row")
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt()
read_csv("nyu_drives.csv") %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt()
read_csv("nyu_drives.csv") %>%
mutate(Outcome = case_when(Outcome == "P" ~ "Pass",
Outcome == "T" ~ "Turnover",
Outcome == "F" ~ "Foul",
TRUE ~ "Shot Attempt")) %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt()
read_csv("nyu_drives.csv") %>%
mutate(Outcome = case_when(Outcome == "P" ~ "Pass",
Outcome == "T" ~ "Turnover",
Outcome == "F" ~ "Foul",
TRUE ~ "Shot Attempt")) %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = Outcome)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_drives.csv") %>%
mutate(Outcome = case_when(Outcome == "P" ~ "Pass",
Outcome == "T" ~ "Turnover",
Outcome == "F" ~ "Foul",
Outcome == "1" ~ "FGM",
TRUE ~ "FGA")) %>%
group_by(Outcome) %>%
summarize(Count = n(),
Middle = sum(`Play Type` == "Middle"),
Baseline = sum(`Play Type` == "Baseline")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = Outcome)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_drives.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_pnr.csv")
read_csv("nyu_pnr.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Drive Outcomes"),
subtitle = "New York University | 3 Closest Games")
read_csv("nyu_pnr.csv") %>%
group_by(`Play Type`) %>%
summarize(Count = n(),
Turnover = sum(Outcome == "T"),
Foul = sum(Outcome == "F"),
FGM = sum(Outcome == "1"),
FGA = sum(Outcome == "0") + sum(Outcome == "1"),
Pass = sum(Outcome == "P")) %>%
ungroup() %>%
arrange(desc(Count)) %>%
adorn_totals("row") %>%
mutate(`FG%` = 100 * round(FGM / FGA, 3)) %>%
gt() %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_title(groups = "title")) %>%
tab_style(style = list(cell_text(weight = "bold")),
locations = cells_body(columns = `Play Type`)) %>%
tab_header(title = md("Pick-and-Roll Outcomes"),
subtitle = "New York University | 3 Closest Games")
